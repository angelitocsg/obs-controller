(this["webpackJsonpobs-controller"]=this["webpackJsonpobs-controller"]||[]).push([[0],{19:function(e,t,n){e.exports=n(57)},20:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){},57:function(e,t,n){"use strict";n.r(t);n(20),n(21),n(22);var a,o,r=n(0),c=n.n(r),s=n(16),u=n.n(s),i=n(4),l=n(1),d=n(18),m=n(3),p=c.a.createContext({}),h=c.a.createContext({}),f={address:"localhost:4444",buttons:8,buttonWidth:100},v=function(){var e=localStorage.getItem("setup");return e?JSON.parse(e):f}(),b=function(e,t){switch(t.type){case"setup":return g(Object(l.a)({},t.payload)),Object(l.a)({},e,{},t.payload);case"status":return Object(l.a)({},e,{status:t.payload});case"scenes":return Object(l.a)({},e,{scenes:t.payload});default:throw new Error("Unhandled action type: ".concat(t.type))}},g=function(e){localStorage.setItem("setup",JSON.stringify(e))},w=function(e){var t=e.children,n=c.a.useReducer(b,v),a=Object(m.a)(n,2),o=a[0],r=a[1];return c.a.createElement(p.Provider,{value:o},c.a.createElement(h.Provider,{value:r},t))},E=function(e){var t=e.status,n=e.toogleSetup;return c.a.createElement("div",{className:"status-line"},c.a.createElement("div",{style:{flex:1}},"Status: ",t),c.a.createElement("div",{style:{float:"right"}},c.a.createElement("button",{className:"btn-setup",onClick:n},"SETUP")))},S=function(e){var t=e.status,n=e.setupData,a=e.toogleSetup,o=e.handleSetupChange;return c.a.createElement("div",{className:"container"},c.a.createElement(E,{status:t,toogleSetup:a}),c.a.createElement("form",null,c.a.createElement("div",{id:"setupArea"},c.a.createElement("div",{className:"formGroup"},c.a.createElement("label",null,"Hostname"),c.a.createElement("input",{name:"address",value:n.address,onChange:o,type:"text"})),c.a.createElement("div",{className:"formGroup"},c.a.createElement("label",null,"Password"),c.a.createElement("input",{name:"password",value:n.password,onChange:o,type:"password",autoComplete:"none"})),c.a.createElement("div",{className:"formGroup"},c.a.createElement("label",null,"Button width"),c.a.createElement("input",{name:"buttonWidth",value:n.buttonWidth,onChange:o,type:"number",step:15,autoComplete:"none"})),c.a.createElement("div",{className:"formGroup"},c.a.createElement("label",null,"Buttons"),c.a.createElement("div",{className:"optButton"},c.a.createElement("input",{type:"radio",value:2,onChange:o,name:"buttons",checked:2===n.buttons}),"2"),c.a.createElement("div",{className:"optButton"},c.a.createElement("input",{type:"radio",value:4,onChange:o,name:"buttons",checked:4===n.buttons}),"4"),c.a.createElement("div",{className:"optButton"},c.a.createElement("input",{type:"radio",value:6,onChange:o,name:"buttons",checked:6===n.buttons}),"6"),c.a.createElement("div",{className:"optButton"},c.a.createElement("input",{type:"radio",value:8,onChange:o,name:"buttons",checked:8===n.buttons}),"8"),c.a.createElement("div",{className:"optButton"},c.a.createElement("input",{type:"radio",value:10,onChange:o,name:"buttons",checked:10===n.buttons}),"10"),c.a.createElement("div",{className:"optButton"},c.a.createElement("input",{type:"radio",value:12,onChange:o,name:"buttons",checked:12===n.buttons}),"12"),c.a.createElement("div",{className:"optButton"},c.a.createElement("input",{type:"radio",value:14,onChange:o,name:"buttons",checked:14===n.buttons}),"14")))))};!function(e){e[e.None=0]="None",e[e.Preview=1]="Preview",e[e.Program=2]="Program"}(a||(a={})),function(e){e.Connected="Connected",e.Disconnected="Disconnected"}(o||(o={}));var y=n(2),C=n.n(y),O=n(5),k=n(17),j=new(n.n(k).a),N=function(){var e=Object(O.a)(C.a.mark((function e(t){var n,a;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=0;case 2:if(!(a<t.length)){e.next=11;break}return e.t0=n,e.next=6,W(t[a]);case 6:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 8:a++,e.next=2;break;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),W=function(){var e=Object(O.a)(C.a.mark((function e(t){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.name){e.next=2;break}return e.abrupt("return",t);case 2:return e.next=4,j.send("TakeSourceScreenshot",{embedPictureFormat:"png",sourceName:t.name,width:t.thumbnailWidth&&2*t.thumbnailWidth}).then((function(e){return Object(l.a)({},t,{thumbnail:e.img})})).catch((function(e){return console.error(e),t}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P={connect:function(e){var t=e.address,n=void 0===t?"localhost:4444":t,a=e.password,o=void 0===a?"":a;return j.connect({address:n,password:o})},getScenes:function(){return j.send("GetSceneList")},getPreview:function(){return j.send("GetPreviewScene")},getThumbs:N,on:function(e,t){j&&(j.on("ConnectionOpened",(function(){console.log("event: ConnectionOpened")})),j.on("ConnectionClosed",(function(e){console.log(e),console.log("event: ConnectionClosed")})),j.on("AuthenticationSuccess",(function(){console.log("event: AuthenticationSuccess")})),j.on("AuthenticationFailure",(function(e){console.log(e),console.log("event: AuthenticationFailure")})),j.on("SwitchScenes",(function(n){console.log("event: SwitchScenes"),"SwitchScenes"===e&&t(n)})))},setCurrentScene:function(e){j.send("SetCurrentScene",{"scene-name":e})}},x=function(){var e=Object(r.useState)(),t=Object(m.a)(e,2),n=t[0],o=t[1],s=Object(r.useRef)(!1),u=function(){var e=c.a.useContext(h);if(void 0===e)throw new Error("useObsDispatch must be used within a CountProvider");return e}(),f=function(){var e=c.a.useContext(p);if(void 0===e)throw new Error("useObsState must be used within a CountProvider");return e}(),v=Object(r.useCallback)((function(){P.getScenes().then((function(e){var t=e.scenes,n=Object(d.a)(e,["scenes"])["current-scene"],r=t.map((function(e){return e.name===n?{name:e.name,thumbnailWidth:f.buttonWidth,status:a.Program}:{name:e.name,thumbnailWidth:f.buttonWidth}}));u({type:"scenes",payload:r}),console.log("Scenes loaded"),P.getThumbs(r).then((function(e){u({type:"scenes",payload:e}),console.log("Thumbs loaded"),P.getPreview().then((function(t){var n=e.map((function(e){return e.name===t.name?Object(l.a)({},e,{status:a.Preview}):e}));u({type:"scenes",payload:n}),o(n)}))}))}))}),[u,f.buttonWidth]),b=Object(r.useCallback)((function(){s.current||(s.current=!0,P.on("SwitchScenes",(function(){v()})))}),[v]);Object(r.useEffect)((function(){return b()}),[b]),Object(r.useEffect)((function(){P.connect({address:f.address,password:f.password}).then((function(){console.log("OBS connected!"),u({type:"status",payload:"Connected"}),v()}))}),[u,f,v]);var g=Object(r.useState)(!1),w=Object(m.a)(g,2),y=w[0],C=w[1],O=Object(r.useState)(Object(l.a)({},f)),k=Object(m.a)(O,2),j=k[0],N=k[1],W=function(){y&&u({type:"setup",payload:j}),C(!y)};return Object(r.useEffect)((function(){return console.log(j)}),[j]),y?c.a.createElement(S,{status:f.status,setupData:j,handleSetupChange:function(e){var t=e.target.name,n=e.target.value;"buttons"===t&&(n=parseInt(n)),"buttonWidth"===t&&(n=parseInt(n)),N(Object(l.a)({},j,Object(i.a)({},t,n)))},toogleSetup:W}):c.a.createElement("div",{className:"container",unselectable:"on"},c.a.createElement(E,{status:f.status,toogleSetup:W}),c.a.createElement("div",{className:"action-line"},null===n||void 0===n?void 0:n.map((function(e,t){return t<(f.buttons||8)&&c.a.createElement("div",{key:t,className:"action-btn ".concat(e.status===a.Program?"program":e.status===a.Preview?"preview":""),style:{minWidth:f.buttonWidth},onClick:function(){return function(e){e&&P.setCurrentScene(e)}(null===e||void 0===e?void 0:e.name)}},c.a.createElement("div",{className:"action-name"},e.name),c.a.createElement("img",{src:e.thumbnail,width:"70",alt:""}))}))))},B=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function A(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}u.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(w,null,c.a.createElement(x,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");B?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):A(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):A(t,e)}))}}()}},[[19,1,2]]]);
//# sourceMappingURL=main.0f1a854e.chunk.js.map