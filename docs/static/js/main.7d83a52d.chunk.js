(this["webpackJsonpobs-controller"]=this["webpackJsonpobs-controller"]||[]).push([[0],{18:function(e,n,t){e.exports=t(55)},19:function(e,n,t){},20:function(e,n,t){},55:function(e,n,t){"use strict";t.r(n);t(19),t(20);var o,c,r=t(0),a=t.n(r),i=t(15),s=t.n(i),u=t(1),l=t(17),d=t(3),f=a.a.createContext({}),v=a.a.createContext({}),h={address:"localhost:4444"},m=function(e,n){switch(n.type){case"status":return Object(u.a)({},e,{status:n.payload});case"scenes":return Object(u.a)({},e,{scenes:n.payload});default:throw new Error("Unhandled action type: ".concat(n.type))}},p=function(e){var n=e.children,t=a.a.useReducer(m,h),o=Object(d.a)(t,2),c=o[0],r=o[1];return a.a.createElement(f.Provider,{value:c},a.a.createElement(v.Provider,{value:r},n))};!function(e){e[e.None=0]="None",e[e.Preview=1]="Preview",e[e.Program=2]="Program"}(o||(o={})),function(e){e.Connected="Connected",e.Disconnected="Disconnected"}(c||(c={}));var w=t(2),g=t.n(w),b=t(4),S=t(16),C=new(t.n(S).a),y=function(){var e=Object(b.a)(g.a.mark((function e(n){var t,o;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],o=0;case 2:if(!(o<n.length)){e.next=11;break}return e.t0=t,e.next=6,O(n[o]);case 6:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 8:o++,e.next=2;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=function(){var e=Object(b.a)(g.a.mark((function e(n){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.name){e.next=2;break}return e.abrupt("return",n);case 2:return e.next=4,C.send("TakeSourceScreenshot",{embedPictureFormat:"png",sourceName:n.name,width:200}).then((function(e){return Object(u.a)({},n,{thumbnail:e.img})})).catch((function(e){return console.error(e),n}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),k={connect:function(e){var n=e.address,t=void 0===n?"localhost:4444":n,o=e.password,c=void 0===o?"":o;return C.connect({address:t,password:c})},getScenes:function(){return C.send("GetSceneList")},getPreview:function(){return C.send("GetPreviewScene")},getThumbs:y,on:function(e,n){C&&(C.on("ConnectionOpened",(function(){console.log("event: ConnectionOpened")})),C.on("ConnectionClosed",(function(e){console.log(e),console.log("event: ConnectionClosed")})),C.on("AuthenticationSuccess",(function(){console.log("event: AuthenticationSuccess")})),C.on("AuthenticationFailure",(function(e){console.log(e),console.log("event: AuthenticationFailure")})),C.on("SwitchScenes",(function(t){console.log("event: SwitchScenes"),"SwitchScenes"===e&&n(t)})))},setCurrentScene:function(e){C.send("SetCurrentScene",{"scene-name":e})}},E=function(){var e=Object(r.useState)(),n=Object(d.a)(e,2),t=n[0],c=n[1],i=Object(r.useRef)(!1),s=function(){var e=a.a.useContext(v);if(void 0===e)throw new Error("useObsDispatch must be used within a CountProvider");return e}(),h=function(){var e=a.a.useContext(f);if(void 0===e)throw new Error("useObsState must be used within a CountProvider");return e}().status;Object(r.useEffect)((function(){console.log("oi")}),[]);var m=Object(r.useCallback)((function(){k.getScenes().then((function(e){var n=e.scenes,t=Object(l.a)(e,["scenes"])["current-scene"],r=n.map((function(e){return e.name===t?{name:e.name,status:o.Program}:{name:e.name}}));s({type:"scenes",payload:r}),console.log("Scenes loaded"),k.getThumbs(r).then((function(e){s({type:"scenes",payload:e}),console.log("Thumbs loaded"),k.getPreview().then((function(n){var t=e.map((function(e){return e.name===n.name?Object(u.a)({},e,{status:o.Preview}):e}));s({type:"scenes",payload:t}),c(t)}))}))}))}),[s]),p=Object(r.useCallback)((function(){i.current||(i.current=!0,k.on("SwitchScenes",(function(){m()})))}),[m]);Object(r.useEffect)((function(){return p()}),[p]),Object(r.useEffect)((function(){k.connect({}).then((function(){console.log("OBS connected!"),s({type:"status",payload:"Connected"}),m()}))}),[s,m]);return a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"status-line"},"Status: ",h),a.a.createElement("div",{className:"action-line"},null===t||void 0===t?void 0:t.map((function(e,n){return n<8&&a.a.createElement("div",{key:n,className:"action-btn ".concat(e.status===o.Program?"program":e.status===o.Preview?"preview":""),onClick:function(){return function(e){e&&k.setCurrentScene(e)}(null===e||void 0===e?void 0:e.name)}},a.a.createElement("div",{className:"action-name"},e.name),a.a.createElement("img",{src:e.thumbnail,width:"70",alt:""}))}))))},j=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function P(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}s.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(p,null,a.a.createElement(E,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");j?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var o=t.headers.get("content-type");404===t.status||null!=o&&-1===o.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):P(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):P(n,e)}))}}()}},[[18,1,2]]]);
//# sourceMappingURL=main.7d83a52d.chunk.js.map